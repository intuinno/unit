!function t(n,e,i){function a(c,o){if(!e[c]){if(!n[c]){var s="function"==typeof require&&require;if(!o&&s)return s(c,!0);if(r)return r(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var l=e[c]={exports:{}};n[c][0].call(l.exports,function(t){var e=n[c][1][t];return a(e?e:t)},l,l.exports,t,n,e,i)}return e[c].exports}for(var r="function"==typeof require&&require,c=0;c<i.length;c++)a(i[c]);return a}({1:[function(t,n,e){"use strict";var i=t("./unit_chart").UnitChart;d3.json("./data/editor.json",function(t,n){i("editorchart",n)}),d3.json("./data/titanic_spec_packxy_hierarchy.json",function(t,n){i("packxy_hierarchy",n)}),d3.json("./data/titanic_spec_packxy_isolated.json",function(t,n){i("packxy_isolated",n)}),d3.json("./data/titanic_spec4.json",function(t,n){i("packxy2",n)}),d3.json("./data/titanic_spec3.json",function(t,n){i("packxy",n)}),d3.json("./data/titanic_spec2.json",function(t,n){i("titanic2",n)}),d3.json("./data/titanic_spec1.json",function(t,n){i("titanic1",n)});var a=document.getElementById("jsoneditor"),r={},c=new JSONEditor(a,r);d3.json("./data/titanic_spec_packxy_hierarchy.json",function(t,n){c.set(n)});var o=d3.select("#updatebutton");o.on("click",function(){var t=c.get();console.log(t),d3.select("#editorchart").select("svg").remove(),i("editorchart",t)})},{"./unit_chart":2}],2:[function(t,n,e){"use strict";function i(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}function a(t,n){d3.csv(n.data,function(e,i){i.forEach(function(t,n){t.id=n});var a=r(i,n),o=c(n.layouts);m(a,o.head),C(a,n,o,t)})}function r(t,n){var e={};return e.contents=t,e.label="root",e.visualspace={width:n.width,height:n.height,posX:0,posY:0},e.layout="StartOfLayout",e.parent="RootContainer",e}function c(t,n){var e={};return e.head=t[0],t.forEach(function(t,n,e){n>0?t.parent=e[n-1]:t.parent="StartOfLayout",n<e.length-1?t.child=e[n+1]:t.child="EndOfLayout"}),e}function o(t,n){var e=d3.nest().key(function(t){return t[n]}).entries(t);return e.map(function(t){return t.key})}function s(t,n){return o(t,n).map(function(t){return{contents:[],label:t,visualspace:{}}})}function u(t,n,e){switch(console.log("calcVisualSpace",e.name),e.containers=n,e.type){case"gridxy":l(t,n,e);break;default:console.log("Unsupported Layout type")}}function l(t,n,e){switch(e.aspect_ratio){case"fillX":case"fillY":h(t,n,e);break;case"square":case"parent":case"custom":f(t,n,e)}}function h(t,n,e){var i=t.visualspace;"fillX"===e.aspect_ratio?n.forEach(function(t,n,e){t.visualspace.width=1*i.width/e.length,t.visualspace.height=i.height,t.visualspace.posX=n*t.visualspace.width,t.visualspace.posY=0}):"fillY"===e.aspect_ratio?n.forEach(function(t,n,e){t.visualspace.height=1*i.height/e.length,t.visualspace.width=i.width,t.visualspace.posY=n*t.visualspace.height,t.visualspace.posX=0}):console.log("TODO")}function f(t,n,e){d(t,n,e)}function d(t,n,e){y(e.direction)?p(t,n,e):calcHeightFillingPackVisualSpace(t,n,e)}function p(t,n,e){var i=v(t.visualspace.width,t.visualspace.height,n.length,1);g(t,n,e,i)}function g(t,n,e,i){var a,r,c,o,s;switch(e.direction){case"LRTB":a=0,r=0,c=i.fillingEdgeSideUnitLength,o=i.remainingEdgeSideUnitLength,s=i.fillingEdgeRepetitionCount;break;case"LRBT":a=0,r=t.visualspace.height-i.remainingEdgeSideUnitLength,c=i.fillingEdgeSideUnitLength,o=-1*i.remainingEdgeSideUnitLength,s=i.fillingEdgeRepetitionCount;break;case"RLBT":case"RLTB":console.log("TODO")}n.forEach(function(t,n,e){t.visualspace.width=i.fillingEdgeSideUnitLength,t.visualspace.height=i.remainingEdgeSideUnitLength,t.visualspace.posX=a+c*(n%s),t.visualspace.posY=r+o*Math.floor(n/s)})}function v(t,n,e,i){var a,r,c,o,s=0;do s++,o=1*t/s,a=o/i,r=Math.floor(1*n/a),c=r*s;while(e>c);return{fillingEdgeRepetitionCount:s,remainingEdgeRepetitionCount:r,fillingEdgeSideUnitLength:o,remainingEdgeSideUnitLength:a}}function y(t){switch(t){case"LRBT":case"LRTB":case"RLBT":case"RLTB":return!0;case"BTLR":case"BTRL":case"TBLR":case"TBLR":return!1}}function E(t,n){var e=t.sizeSharingGroup;return d3.min(e,function(t){return t.visualspace[n]})}function w(t,n){var e=L(n.sizeSharingGroup);e.forEach(function(e){var i=S(e,t,n);g(e,e.contents,n,i)})}function L(t){var n=new Set;return t.forEach(function(t){n.add(t.parent)}),[].concat(i(n))}function S(t,n,e){var i,a=Math.round(t.visualspace.width/n),r=0;return"square"===e.aspect_ratio?i=n:console.log("TODO"),{fillingEdgeRepetitionCount:a,remainingEdgeRepetitionCount:r,fillingEdgeSideUnitLength:n,remainingEdgeSideUnitLength:i}}function m(t,n){var e=T(t,n);u(t,e,n),"EndOfLayout"!==n.child&&e.forEach(function(t){m(t,n.child)}),t.contents=e,_(t,n),console.log("Fininshing",n.name)}function _(t,n){n.size.isShared?(n.hasOwnProperty("sizeSharingGroup")||(n.sizeSharingGroup=[]),n.sizeSharingGroup=n.sizeSharingGroup.concat(t.contents)):k(n.child)}function k(t){"EndOfLayout"!==t&&t.size.isShared===!0&&("EndOfLayout"!=t.child&&t.child.size.isShared&&k(t.child),O(t),t.sizeSharingGroup=[])}function O(t){switch(t.aspect_ratio){case"fillX":case"fillY":R(t);break;case"square":case"parent":case"custom":j(t)}}function R(t){console.log("TODO: makeSharedSizeFill")}function j(t){if(console.log(t),y(t.direction)){var n=E(t,"width");w(n,t)}else{calcHeightFillingPackVisualSpace(parentContainer,childContainers,t);E(childContainers,"height")}}function T(t,n){var e=U(t,n,"groupby"),i=b(e),a=s(i,n.groupby.key);return a.forEach(function(e,i,a){e.contents=t.contents.filter(function(t){return t[n.groupby.key]==e.label}),e.parent=t}),a}function U(t,n,e){return n[e].isShared&&"RootContainer"!==t.parent?U(t.parent,n.parent,e):t}function b(t){if(x(t)){var n=[];return t.contents.forEach(function(t){var e=b(t);e.forEach(function(t){n.push(t)})}),n}return[t]}function x(t){return!!(t.hasOwnProperty("contents")&&t.hasOwnProperty("visualspace")&&t.hasOwnProperty("parent"))}function C(t,n,e,i){var a=n.layouts,r=n.mark,c=d3.select("#"+i).append("svg").attr("width",n.width).attr("height",n.height),o=c.selectAll(".root").data([t]).enter().append("g").attr("class","root").attr("transform",function(t){return"translate("+t.visualspace.posX+", "+t.visualspace.posY+")"}),s=o;a.forEach(function(t){var n=s.selectAll("."+t.name).data(function(t){return t.contents}).enter().append("g").attr("class",t.name).attr("transform",function(t){return"translate("+t.visualspace.posX+", "+t.visualspace.posY+")"});n.append("rect").attr("x",0).attr("y",0).attr("width",function(t){return t.visualspace.width}).attr("height",function(t){return t.visualspace.height}).style("opacity",.03).style("fill","blue").style("stroke","black").style("stroke-width","1"),s=n}),s.append("circle").attr("cx",function(t){return t.visualspace.width/2}).attr("cy",function(t){return t.visualspace.height/2}).attr("r",function(n){return z(n,t,r,e)}).style("fill",function(t){return"purple"})}function z(t,n,e,i){var a;return a=e.size.isShared?X(t,n,e,i):B(t,e)}function B(t,n){var e=t.visualspace.width,i=t.visualspace.height;if("max"===n.size.type)return e>i?i/2:e/2}function X(t,n,e,i){var a=Y(n,i.head);return d3.min(a,function(t){return B(t,e)})}function Y(t,n){if("EndOfLayout"!==n.child){var e=[];return t.contents.forEach(function(t){var i=Y(t,n.child);i.forEach(function(t){e.push(t)})}),e}return t.contents}Object.defineProperty(e,"__esModule",{value:!0}),e.UnitChart=a},{}]},{},[1]);